<?xml version="1.0" encoding="utf-8"?>
<sql-descriptor id="bp/tcams/init/PIWR" data-source="tcamsDS">
 <sql id="PKGT">
  <![CDATA[
WITH T1 (
  PKMS_CORP_CODE
 ,PKMS_COME_CODE
 ,PKMS_TABL_ID
 ,PKMS_SORT_NUMB
 ,PKMS_TABL_NAME
 ,PKMS_UPDT_DATE
 ,PKMS_UPDT_CMAN
 ,PKMS_INIT_DATE
 ,PKMS_INIT_CMAN
) AS (
       SELECT 'K1', 'I', 'ESAAUMM'       , 1, null, 'ESAAUMM', 'bp/tcams/init/PIWR'         , '20250502', 'bp/tcams/init/PIWR'        FROM DUAL
 UNION SELECT 'K1', 'I', 'ESAAUML'       , 2, null, 'ESAAUML', 'bp/tcams/init/PIWR'         , '20240502', 'bp/tcams/init/PIWR'        FROM DUAL
 UNION SELECT 'K1', 'I', 'ESAAURF'       , 3, null, 'ESAAURF', 'bp/tcams/init/PIWR'         , '20240502', 'bp/tcams/init/PIWR'        FROM DUAL
 UNION SELECT 'K1', 'I', 'CITBMTCD'      , 4, null, 'CITBMTCD','bp/tcams/init/PIWR'         , '20240502', 'bp/tcams/init/PIWR'        FROM DUAL
 UNION SELECT 'K1', 'I', 'CITBMTDG'      , 5, null, 'CITBMTDG','bp/tcams/init/PIWR'         , '20240502', 'bp/tcams/init/PIWR'        FROM DUAL
)
SELECT CASE WHEN D.OBJECT_NAME IS NOT NULL THEN 'Y' ELSE 'N' END CREATED_YN
      ,D.STATUS
      ,D.CREATED
      ,A.PKMS_TABL_ID C2
      ,A.*
  FROM T1 A
      LEFT OUTER JOIN
       USER_OBJECTS D
      ON D.OBJECT_NAME = A.PKMS_TABL_ID
 ORDER BY A.PKMS_SORT_NUMB     
  ]]>
 </sql>

 <sql id="ESAAUMM">
  <![CDATA[
WITH T1 (
  SYS_ID
 ,MENU_CD
 ,UP_MENU_CD
 ,LINK_URL
 ,USR_CLS
 ,MENU_TYP
 ,SORT_ORD
 ,USE_YN
 ,REM
 ,STS
 ,REG_ID
 ,REG_DT
 ,MOD_ID
 ,MOD_DT
) AS (
  SELECT '100', 'PCF30270', 'PCF00000', 'ui/bp/tcams/ca/piwr/em-capiwr-p19.html', 'B', NULL, 54, 'N', NULL, 'U', 'SYSTEM', '2017-12-04 17:40:00.0 Asia/Seoul', 'ADMIN', '2019-12-23 13:49:36.0 Asia/Seoul' FROM DUAL
)
SELECT CASE WHEN B.SYS_ID IS NOT NULL THEN 'Y' ELSE 'N' END CHK_YN
      ,A.* 
  FROM T1 A
      LEFT OUTER JOIN 
       ESAAUMM B
      ON    B.SYS_ID  = A.SYS_ID
        AND B.MENU_CD = A.MENU_CD
  ]]>
 </sql>

 <sql id="ESAAUML" comment="조회">
  <![CDATA[
WITH T1 (
  SYS_ID
 ,LANG_CD
 ,MENU_CD
 ,MENU_NM
 ,REM
 ,STS
 ,REG_ID
 ,REG_DT
 ,MOD_ID
 ,MOD_DT
) AS ( 
  SELECT '100', 'ko_KR', 'PCF30270', 'PIPE가공', NULL, 'U', 'SYSTEM', '2017-12-04 17:40:00.0 Asia/Seoul', 'ADMIN', '2019-12-23 13:49:36.0 Asia/Seoul' FROM DUAL
)
SELECT CASE WHEN B.SYS_ID IS NOT NULL THEN 'Y' ELSE 'N' END CHK_YN
      ,A.* 
  FROM T1 A
      LEFT OUTER JOIN 
       ESAAUML B
      ON    B.SYS_ID  = A.SYS_ID
        AND B.LANG_CD = A.LANG_CD
        AND B.MENU_CD = A.MENU_CD
  ]]>
 </sql>

 <sql id="ESAAURF" comment="조회">
  <![CDATA[
WITH T1 (
  SYS_ID
 ,ROLE_CD
 ,FUNC_CD
 ,MENU_CD
 ,REG_ID
 ,REG_DT
) AS ( 
 SELECT '100', 'M10', 'ALL', 'PCF30270', 'SYSTEM', '20200320111520' FROM DUAL
)
SELECT CASE WHEN B.SYS_ID IS NOT NULL THEN 'Y' ELSE 'N' END CHK_YN
      ,A.* 
  FROM T1 A
      LEFT OUTER JOIN 
       ESAAURF B
      ON    B.SYS_ID  = A.SYS_ID
        AND B.ROLE_CD = A.ROLE_CD
        AND B.FUNC_CD = A.FUNC_CD
        AND B.MENU_CD = A.MENU_CD
  ]]>
 </sql>

 <sql id="CITBMTCD" comment="조회">
  <![CDATA[
WITH T1 (
  MTCD_CORP_CODE
 ,MTCD_METH_GUBN
 ,MTCD_COME_CODE
 ,MTCD_METH_NAME
 ,MTCD_INDS_CODE
 ,MTCD_MATL_CLAS
 ,MTCD_SORT_KEY0
 ,MTCD_UPDT_DATE
 ,MTCD_UPDT_CMAN
 ,MTCD_INIT_DATE
 ,MTCD_INIT_CMAN
 ,MTCD_DOCU_NUMB
) AS ( 
  SELECT 'K1', 'A', 'PIWR', 'PIPE가공', 'P2', 'SD', 19, '20171214', 'SYSTEM', '20171214', 'SYSTEM', 'TRANSYS-G-P2-07' FROM DUAL
)
SELECT CASE WHEN B.MTCD_CORP_CODE IS NOT NULL THEN 'Y' ELSE 'N' END CHK_YN
      ,CASE 
        WHEN A.MTCD_UPDT_DATE = '00000000' THEN 'D'
        WHEN B.MTCD_CORP_CODE IS NULL THEN 'I'
        ELSE 'X'
       END  MG_MODE
      ,A.* 
  FROM T1 A
      LEFT OUTER JOIN 
       CITBMTCD B
      ON    B.MTCD_CORP_CODE = A.MTCD_CORP_CODE
        AND B.MTCD_METH_GUBN = A.MTCD_METH_GUBN
        AND B.MTCD_COME_CODE = A.MTCD_COME_CODE
  ]]>
 </sql>

 <sql id="CITBMTDG" comment="조회">
  <![CDATA[
WITH T1 (
  MTDG_CORP_CODE
 ,MTDG_METH_GUBN
 ,MTDG_COME_CODE
 ,MTDG_STND_DEGR
 ,MTDG_REGT_NO
 ,MTDG_REVI_DATE
 ,MTDG_APPL_DATE
 ,MTDG_HKMC_DEGR
 ,MTDG_DEGR_CONT
 ,MTDG_STND_FILE
 ,MTDG_STND_MAN1
 ,MTDG_PHON_NO1
 ,MTDG_STND_MAN2
 ,MTDG_PHON_NO2
 ,MTDG_MENU_ID
 ,MTDG_MXML_PATH
 ,MTDG_ATT_GRP_CD
 ,MTDG_APPL_YN
 ,MTDG_UPDT_DATE
 ,MTDG_UPDT_CMAN
 ,MTDG_INIT_DATE
 ,MTDG_INIT_CMAN
 ,MTDG_TRAN_DEGR
 ,MTDG_MCHH_DATE
 ,MTDG_MODL_NAME
) AS (
           SELECT 'K1' ,'A' ,'PIWR' ,'18' ,NULL ,'20171201' ,'20171201' ,'18' ,'원가계산기준 일원화' ,NULL ,'우한섭' ,'5295' ,'한창선' ,'5272' ,'PCF30270' ,'ui/bp/tcams/ca/piwr/em-capiwr-p19.html' ,'13607' ,'Y' ,'20171214' ,'SYSTEM' ,'20171214' ,'SYSTEM' ,'1', NULL, NULL  FROM DUAL
 UNION ALL SELECT 'K1' ,'A' ,'PIWR' ,'19' ,NULL ,'20221102' ,'20221102' ,'19' ,'SUS파이프 조관 추가 外' ,NULL ,'안정환' ,'5374' ,'나종훈' ,'5272' ,'PCF30270' ,'ui/bp/tcams/ca/piwr/em-capiwr-p19.html' ,'1586734849775' ,'Y' ,'20191211' ,'SYSTEM' ,'20191211' ,'SYSTEM' ,'2', NULL, NULL  FROM DUAL
 UNION ALL SELECT 'K1' ,'A' ,'PIWR' ,'19-1' ,NULL ,'20230601' ,'20230501' ,'19-1' ,'전력단가 변경' ,NULL ,'안정환' ,'5374' ,'나종훈' ,'5272' ,'PCF30270' ,'ui/bp/tcams/ca/piwr/em-capiwr-p19.html' ,NULL ,'Y' ,'20230501' ,'ADMIN' ,'20230501' ,'ADMIN' ,'4', NULL, NULL  FROM DUAL
 UNION ALL SELECT 'K1' ,'A' ,'PIWR' ,'19-3' ,NULL ,'20240215' ,'20240215' ,'19-3' ,'전력단가변경' ,NULL ,'안정환' ,'5374' ,'나종훈' ,'5272' ,'PCF30270' ,'ui/bp/tcams/ca/piwr/em-capiwr-p19.html' ,NULL ,'Y' ,'20240215' ,'ADMIN' ,'20240215' ,'ADMIN' ,'5', '20240215', 'CASPPIWR_P19_3'  FROM DUAL
)
SELECT CASE WHEN B.MTDG_CORP_CODE IS NOT NULL THEN 'Y' ELSE 'N' END CHK_YN
      ,CASE WHEN A.MTDG_UPDT_DATE > B.MTDG_UPDT_DATE THEN 'N' ELSE 'Y' END UPDATED_YN
      ,CASE
        WHEN B.MTDG_CORP_CODE IS NULL            THEN 'I'
        WHEN A.MTDG_UPDT_DATE > B.MTDG_UPDT_DATE THEN 'U'  
        ELSE 'X'
       END MG_MODE
      ,A.* 
  FROM T1 A
      LEFT OUTER JOIN 
       CITBMTDG B
      ON    B.MTDG_CORP_CODE = A.MTDG_CORP_CODE
        AND B.MTDG_METH_GUBN = A.MTDG_METH_GUBN
        AND B.MTDG_COME_CODE = A.MTDG_COME_CODE
        AND B.MTDG_STND_DEGR = A.MTDG_STND_DEGR
 ORDER BY A.MTDG_APPL_DATE        
  ]]>
 </sql>

</sql-descriptor>